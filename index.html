<!DOCTYPE html>
<html>
    <head>
        <title>Internet Speed Test Results</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
        <style>
          body {
            padding: 15px;
            font-size: 16px;
          }
          .buttons {
            padding-top: 10px;
            padding-bottom: 10px;
            padding-left: 9px;
          }
          .buttons a {
            border-radius: 5px;
            border: 1px solid rgba(22, 168, 217, 0.5);
            padding: 10px;
          }
          .buttons a:hover {
            text-decoration: none;
          }
          th {
            color: #81b0d9c9;
          }
          th, td {
            font-size: 16px;
          }
          .download-cell {
            color: #6AFFF3;
          }
          .upload-cell {
            color: #BF71FF;
          }
        </style>
    </head>
    <body>
        <div class="buttons">
          <a href="#" id="one-minute-button">Show every 1 minute</a>
          <a href="#" id="five-minutes-button">Show every 5 minutes</a>
          <a href="#" id="ten-minutes-button">Show every 10 minutes</a>
        </div>

        <table id="resultsTable">
            <tr>
                <th>Timestamp</th>
                <th>Download Speed (Mbps)</th>
                <th>Upload Speed (Mbps)</th>
                <th>Ping</th>
                <th>Server</th>
                <th>Client IP</th>
            </tr>
        </table>

        <script>
          fetch('results-clean.json')
              .then(response => response.json())
              .then(data => {
                  let table = document.getElementById('resultsTable');

                  // Reverse the data array
                  data = data.reverse();

                  for (let item of data) {
                      let row = document.createElement('tr');
                      row.classList.add('table-row'); // Add class to the row

                      let cell = document.createElement('td');
                      cell.textContent = new Date(item.timestamp).toLocaleString();
                      cell.classList.add('timestamp-cell'); // Add class to the cell
                      row.appendChild(cell);

                      cell = document.createElement('td');
                      cell.textContent = (item.download / (1024 * 1024)).toFixed(2);
                      cell.classList.add('download-cell'); // Add class to the cell
                      row.appendChild(cell);

                      cell = document.createElement('td');
                      cell.textContent = (item.upload / (1024 * 1024)).toFixed(2);
                      cell.classList.add('upload-cell'); // Add class to the cell
                      row.appendChild(cell);

                      cell = document.createElement('td');
                      cell.textContent = item.ping.toFixed(2);
                      cell.classList.add('ping-cell'); // Add class to the cell
                      row.appendChild(cell);

                      cell = document.createElement('td');
                      cell.textContent = `${item.server.name}, ${item.server.country}`;
                      cell.classList.add('server-cell'); // Add class to the cell
                      row.appendChild(cell);

                      cell = document.createElement('td');
                      cell.textContent = item.client.ip;
                      cell.classList.add('ip-cell'); // Add class to the cell
                      row.appendChild(cell);

                      table.appendChild(row);
                  }
            });

            // Show every 1 minute
            document.getElementById('one-minute-button').addEventListener('click', function() {
              showAllRows();
              let table = document.getElementById('resultsTable');
              let rows = table.getElementsByClassName('table-row');

              for (let row of rows) {
                let timestamp = row.getElementsByClassName('timestamp-cell')[0].textContent;
                let date = new Date(timestamp);
                let minutes = date.getMinutes();

                if (minutes % 1 !== 0) {
                  row.style.display = 'none';
                }
              }
            });

            // Show every 5 minutes
            document.getElementById('five-minutes-button').addEventListener('click', function() {
              showAllRows();
              let table = document.getElementById('resultsTable');
              let rows = table.getElementsByClassName('table-row');

              for (let row of rows) {
                let timestamp = row.getElementsByClassName('timestamp-cell')[0].textContent;
                let date = new Date(timestamp);
                let minutes = date.getMinutes();

                if (minutes % 5 !== 0) {
                  row.style.display = 'none';
                }
              }
            });

            // Show every 10 minutes
            document.getElementById('ten-minutes-button').addEventListener('click', function() {
              showAllRows();
              let table = document.getElementById('resultsTable');
              let rows = table.getElementsByClassName('table-row');

              for (let row of rows) {
                let timestamp = row.getElementsByClassName('timestamp-cell')[0].textContent;
                let date = new Date(timestamp);
                let minutes = date.getMinutes();

                if (minutes % 10 !== 0) {
                  row.style.display = 'none';
                }
              }
            });

            // Remove display none from all rows
            const showAllRows = () => {
              let table = document.getElementById('resultsTable');
              let rows = table.getElementsByClassName('table-row');

              for (let row of rows) {
                row.style.display = 'table-row';
              }
            };
        </script>
    </body>
</html>
